# ‚öôÔ∏è CONFIGURACI√ìN RENDER - BOT INTERCAPITAL

## üöÄ GU√çA R√ÅPIDA DE CONFIGURACI√ìN

### 1Ô∏è‚É£ Acceder a Variables de Entorno

1. Ir a tu servicio en Render: https://dashboard.render.com
2. Seleccionar tu servicio del chatbot WhatsApp
3. Click en **"Environment"** en el men√∫ lateral
4. Click en **"Add Environment Variable"**

---

### 2Ô∏è‚É£ Agregar Variables de Intercapital

Agregar las siguientes variables **exactamente como se muestran**:

#### Variable 1: URL de la API
```
Key:   INTERCAPITAL_API_URL
Value: https://app1.intercapital.ar/api/chatbot
```

#### Variable 2: API Key
```
Key:   INTERCAPITAL_API_KEY
Value: 2e590cf1f4fd1144f1ce0622347c046a0fa3e2bd786114273094049b6cd55c0a
```

#### Variable 3: Timeout (Opcional)
```
Key:   INTERCAPITAL_TIMEOUT
Value: 30000
```

#### Variable 4: Retry Attempts (Opcional)
```
Key:   INTERCAPITAL_RETRY_ATTEMPTS
Value: 3
```

---

### 3Ô∏è‚É£ Guardar y Reiniciar

1. Click en **"Save Changes"**
2. Render reiniciar√° autom√°ticamente el servicio
3. Esperar 2-3 minutos a que el servicio est√© activo

---

### 4Ô∏è‚É£ Verificar Configuraci√≥n

Una vez que el servicio est√© activo, verificar en los logs:

```bash
# En Render logs, buscar:
‚úÖ Variables de entorno cargadas
‚úÖ INTERCAPITAL_API_URL configurada
‚úÖ INTERCAPITAL_API_KEY configurada
```

---

## üß™ TESTING POST-DEPLOY

### Paso 1: Configurar MongoDB

Ejecutar el script de setup **UNA SOLA VEZ**:

```bash
# En tu m√°quina local
cd backend
node scripts/setup-intercapital.js
```

**Salida esperada:**
```
‚úÖ Conectado a MongoDB
‚úÖ Empresa encontrada: Intercapital
‚úÖ CONFIGURACI√ìN INTERCAPITAL CREADA

üìã Resumen:
   - Endpoints: 4
   - Workflows: 5
```

### Paso 2: Limpiar Estado de Testing

```bash
# Antes de cada test
node scripts/limpiar-estado-intercapital.js
```

### Paso 3: Probar en WhatsApp

1. Escribir: **"hola"** o **"intercapital"**
2. Deber√≠as ver el men√∫ principal
3. Probar cada opci√≥n del men√∫

---

## ‚úÖ CHECKLIST DE CONFIGURACI√ìN

- [ ] Variables de entorno agregadas en Render
- [ ] Servicio reiniciado correctamente
- [ ] Script `setup-intercapital.js` ejecutado
- [ ] Men√∫ principal funciona en WhatsApp
- [ ] Flujo de compra funciona
- [ ] Flujo de venta funciona
- [ ] Flujo de retiro funciona
- [ ] Flujo de consulta funciona

---

## üîß TROUBLESHOOTING

### Problema: "API Key inv√°lida"
**Soluci√≥n:** Verificar que la API key est√© copiada exactamente sin espacios

### Problema: "No se encuentra el workflow"
**Soluci√≥n:** Ejecutar `node scripts/setup-intercapital.js` nuevamente

### Problema: "El bot no responde"
**Soluci√≥n:** 
1. Verificar logs de Render
2. Verificar que las variables est√©n configuradas
3. Reiniciar el servicio

### Problema: "Error de conexi√≥n a la API"
**Soluci√≥n:**
1. Verificar que la URL sea correcta
2. Probar el health check: `curl https://app1.intercapital.ar/api/chatbot/health`
3. Verificar que la API key sea v√°lida

---

## üìä MONITOREO

### Ver Logs en Render

1. Ir a tu servicio en Render
2. Click en **"Logs"** en el men√∫ lateral
3. Buscar mensajes de Intercapital:

```
[INTERCAPITAL] GET /usuarios/validate
[INTERCAPITAL] ‚úÖ 200 /usuarios/validate
[INTERCAPITAL] POST /ordenes
[INTERCAPITAL] ‚úÖ 201 /ordenes
```

---

## üéØ RESUMEN

**Tiempo estimado:** 5-10 minutos

**Pasos:**
1. ‚úÖ Agregar 2 variables obligatorias en Render
2. ‚úÖ Guardar y esperar reinicio (2-3 min)
3. ‚úÖ Ejecutar script de setup en local
4. ‚úÖ Probar en WhatsApp

**¬°Listo para usar!** üöÄ
